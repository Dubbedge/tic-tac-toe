var TicTacToe=function(){var a={scoring:{x:0,y:0,draws:0},moves:0,total:0,turnX:!0,boardSize:3,draw:"draw",playersName1:"Player 1",playersName2:"Player 2",resetBoard:function(){$(".css-game-result-display").hide();a.moves=0;$("td.css-font").html("&nbsp;");a.board&&delete a.board;a.board=[];for(var b,d=0;d<a.boardSize;d+=1){b=[];for(var c=0;c<a.boardSize;c+=1)b.push("");a.board.push(b)}$("table tr").remove();a.createBoard(a.boardSize);$(".js-turn").text(a.turnX?a.playersName1:a.playersName2)},resetScores:function(){a.scoring.x=0;a.scoring.y=0;a.scoring.draws=0;a.moves=0;a.total=0;a.turnX=!0;a.updateScores()},createBoard:function(b){for(var d="",c=0,f="",e=0;e<b;e+=1){for(var d=d.concat("<tr>"),g=0;g<b;g+=1)f="",0!==g&&g!==b-1&&(f="css-left-right"),0!==g&&g!==b-1&&0!==e&&e!==b-1?f="css-left-right css-top-bottom":0!==e&&e!==b-1&&(f="css-top-bottom"),d=d.concat("<td class='css-font "+f+"' data-number='"+c+"'></td>"),c+=1;d=d.concat("</tr>")}$(".css-margin-auto").css("width","");$(".css-table").append(d);$(".css-margin-auto").width($(".css-table").width());$(".css-font").on("click",function(){var b=$(this).text().trim(),c=parseInt($(this).attr("data-number"),10);b||(a.turnX?($(this).text("X"),a.updateBoardArray(c,"X")):($(this).text("O"),a.updateBoardArray(c,"O")),(b=a.checkForWinner())?(a.declareResult(b),a.total+=1,a.updateScores()):a.changeTurn())})},showWin:function(b,d){switch(d){case "row":for(var c=0;c<a.boardSize;c++)$("[data-number='"+((b+1)*a.boardSize-(c+1))+"'].css-font").css("background-color","#c3ffc3");break;case "col":for(c=0;c<a.boardSize;c++)$("[data-number='"+(b+a.boardSize*c)+"'].css-font").css("background-color","#c3ffc3");break;case "ang1":for(c=0;c<a.boardSize;c++)$("[data-number='"+(c+c*a.boardSize)+"'].css-font").css("background-color","#c3ffc3");break;case "ang2":for(c=0;c<a.boardSize;c++)$("[data-number='"+(-(c+1)+(c+1)*a.boardSize)+"'].css-font").css("background-color","#c3ffc3");break;default:$(".css-font").css("background-color","#ffeed2")}},changeTurn:function(){a.turnX=!a.turnX;$(".css-turn").text(a.turnX?a.playersName1:a.playersName2)},updateBoardArray:function(b,d){var c=a.boardSize*a.boardSize;if(!(0>b||b>c-1||"X"!==d&&"O"!==d)){for(var f=0,e=a.boardSize;e<=c;e+=a.boardSize){if(b<e){a.board[f][b-(e-a.boardSize)]=d;break}f++}a.moves+=1}},updateScores:function(){$(".js-x-wins").text(a.scoring.x);$(".js-y-wins").text(a.scoring.y);$(".js-draws").text(a.scoring.draws);$(".js-total-games").text(a.total)},checkAnswer:function(b){var d=Array(a.boardSize+1).join("X"),c=Array(a.boardSize+1).join("O");return b===d?a.playersName1:b===c?a.playersName2:""},checkForWinner:function(){for(var b,d,c=0;c<a.boardSize;c+=1)if(b=a.board[c].join(""),b.length===a.boardSize&&(d=a.checkAnswer(b)))return a.showWin(c,"row"),d;for(b=0;b<a.boardSize;b+=1){d="";for(c=0;c<a.boardSize;c+=1)d=d.concat(a.board[c][b]);if(d=a.checkAnswer(d))return a.showWin(b,"col"),d}b=d="";for(var f=c=0,e=a.boardSize-1;c<a.boardSize;c+=1,f+=1,--e)d=d.concat(a.board[c][f]),b=b.concat(a.board[c][e]);return(d=a.checkAnswer(d))?(a.showWin(null,"ang1"),d):(d=a.checkAnswer(b))?(a.showWin(null,"ang2"),d):a.moves===a.boardSize*a.boardSize?(a.showWin(),a.draw):""},declareResult:function(b){var d="DRAW!";b===a.playersName1?(d=a.playersName1+" Wins!",a.scoring.x+=1,a.turnX=!0):b===a.playersName2?(d=a.playersName2+" Wins!",a.scoring.y+=1,a.turnX=!1):(a.scoring.draws+=1,a.turnX=!0);$(".js-win-title").text(d);$(".css-game-result-display").show()},changeBoardSize:function(b){3<=b&&5>=b&&(a.boardSize=b,a.resetBoard())}},h={initGame:function(){a.resetScores();a.resetBoard()}};return{init:{initGame:function(){h.initGame()}},game:{changeBoardSize:function(b){a.changeBoardSize(b)},playAgain:function(){a.resetBoard()}}}}();$(document).ready(function(){TicTacToe.init.initGame();$(".js-reset-game").on("click",function(){TicTacToe.init.initGame()});$(".js-play-again").on("click",function(){TicTacToe.game.playAgain()});$("div.modal-footer .js-save-board-size").on("click",function(){var a=parseInt($("#saveBoardSizeModal").modal().find(".js-board-size-input").val(),10);TicTacToe.game.changeBoardSize(a);$("#saveBoardSizeModal").modal("hide")});$("div.modal-body .js-board-size-input").on("keydown",function(){-1!==$.inArray(event.keyCode,[46,8,9,27,13,110])||65===event.keyCode&&(!0===event.ctrlKey||!0===event.metaKey)||51<=event.keyCode&&53>=event.keyCode||(51>event.keyCode||53<event.keyCode)&&event.preventDefault()})});